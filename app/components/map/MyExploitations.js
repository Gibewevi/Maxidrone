// MyExploitations.js
"use client"

import React, { useEffect } from 'react';
import L from 'leaflet';
import { useMap } from 'react-leaflet';

export default function MyExploitations() {
    const map = useMap();

    const marketLocation = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="#03A9F4" d="M16 2A11.013 11.013 0 0 0 5 13a10.889 10.889 0 0 0 2.216 6.6s.3.395.349.452L16 30l8.439-9.953c.044-.053.345-.447.345-.447l.001-.003A10.885 10.885 0 0 0 27 13A11.013 11.013 0 0 0 16 2Zm0 15a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4Z"/><circle cx="16" cy="13" r="4" fill="none"/></svg>`;

    const icon = L.divIcon({
        className: "my-custom-pin",
        iconSize: [32, 32],
        iconAnchor: [16, 32],
        popupAnchor: [0, -32],
        html: marketLocation
    });

    const exploitations = [
        {
            name: "Exploitation Des Alpes",
            owner: "Jean Dupont",
            coordinates: [44.840440, 6.274509]
        },
        {
            name: "Exploitation Du Nord",
            owner: "Jean Dupont",
            coordinates: [50.629250, 3.057256]
        }
    ];

    useEffect(() => {
        exploitations.forEach(exploitation => {
            L.marker(exploitation.coordinates, { icon: icon })
                .addTo(map)
                .bindPopup(`${exploitation.name}<br>PropriÃ©taire: ${exploitation.owner}`)
                .on('click', () => {
                    map.flyTo(exploitation.coordinates, 14);
                });
        });
    }, [map, icon, exploitations]);

    return null;
}
